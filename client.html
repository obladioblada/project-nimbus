<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Project Nimbus</title>
</head>
<body>
<input type="text" id="url" placeholder="Input Lamda URL" style="
                    width: 100%;
                    height: 36px;
                    border-radius: 4px;
                    padding-left: 12px;
                    font-size: 14px;
                    font-weight: normal;
                    border: 1px solid rgb(137, 151, 155);
                    transition: border-color 150ms ease-in-out 0s;
                    outline: none;
                    color: rgb(33, 49, 60);
                    background-color: rgb(255, 255, 255);
                    padding-right: 12px;
                    :hover{
                        box-shadow: rgb(231 238 236) 0px 0px 0px 3px;
                    }
                ">
<br><br>
<input type="file" id="fileInput">
<p>Upload percentage: <span id="uploadPercent"></span> </p>
<br><br>
</body>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script language="JavaScript">
    
    document.getElementById("fileInput").addEventListener('change', handleFileChange);
    async function handleFileChange(e) {
        const URL = document.getElementById("url").value;
        
        //hack for local testing
        let localTestingUrl  = URL.replace("https", "http")
        try {
            // take the first file from FilesList
            const file = e.target.files[0];
            // Extract Content-Type & filename
            const {
                type,
                name
            } = file;
            
            console.log(name)
            console.log(type)
            console.log(localTestingUrl)
            // Get upload URL
            let resp = await axios.put(
                localTestingUrl, {
                    contentType: type,
                    ext: name.split(".").pop(), // take only file extension
                    isPublic: true, // make it public so you can preview
                }
            );
            
            await axios.put(URL, file, {
                headers: {
                    "Content-Type": file.type
                },
                
                onUploadProgress: (e) => {
                    //  Show progress
                    document.getElementById("uploadPercent").innerHTML = Math.round((e.loaded * 100) / e.total);
                },
            });
            
            // suuccessfully uploaded
            document.getElementById("uploadPercent").innerHTML = "Completed";
        } catch (e) {
            // Log errors
            console.log(e);
        }
    }
</script>
</html>